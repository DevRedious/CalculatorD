var w=Object.defineProperty;var I=(h,e,t)=>e in h?w(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var m=(h,e,t)=>I(h,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const x={boss:{label:"Boss Calculator",description:"Calculez les ressources n√©cessaires pour les boss",icon:"üëπ"},key:{label:"Key Calculator",description:"Calculez les ressources n√©cessaires pour les cl√©s",icon:"üóùÔ∏è"},"ancient-token":{label:"Ancient Token Calculator",description:"Calculez les ressources n√©cessaires pour les Ancient Tokens",icon:"ü™ô"}},C=["T4_Abyssal","T4_Celestial","T5_Nidhogg","T5_Chaos","T5_Order","T6_Normal","T6_Giga","T7_DodoBleu","T7_DodoRouge","T7_WReaper","T7_WGiga","T8_Ascension","T8_Descension","T9_1Seal","T9_2Seal","T9_3Seal","T9_4Seal","T9_Cube"],M=Object.fromEntries(C.map(h=>[h,h.replace("_"," ")])),l="/icons-20260117T210540Z-1-001/icons/",p={defaultCount:0,minCount:0,maxCount:999,storageKey:"calculator_selection",autoSaveDelay:1e3,maxHistoryItems:10,inputDebounceDelay:300,toastDuration:3e3,defaultTheme:"dark",themeStorageKey:"calculator_theme"};function E(h){return M[h]??h}const _={Artefact:{icon:`${l}artefact.png`,costs:{T4_Abyssal:2,T4_Celestial:2,T5_Nidhogg:4,T5_Chaos:3,T5_Order:3,T6_Normal:3,T6_Giga:3,T7_DodoBleu:3,T7_DodoRouge:3,T7_WReaper:3,T7_WGiga:3,T8_Ascension:5,T8_Descension:5,T9_1Seal:3,T9_2Seal:5,T9_3Seal:5,T9_4Seal:5,T9_Cube:3}},"Abyssal Warfare Key":{icon:`${l}abyssal_key.png`,costs:{T5_Nidhogg:1,T5_Chaos:1,T5_Order:1,T8_Ascension:1,T8_Descension:1,T9_1Seal:1,T9_2Seal:1,T9_3Seal:1,T9_4Seal:1,T9_Cube:1}},"Celestial Warfare Key":{icon:`${l}celestial_key.png`,costs:{T5_Nidhogg:1,T5_Chaos:1,T5_Order:1,T8_Ascension:1,T8_Descension:1,T9_1Seal:1,T9_2Seal:1,T9_3Seal:1,T9_4Seal:1,T9_Cube:1}},"Ancient Token Cluster":{icon:`${l}ancient_token.png`,costs:{T4_Abyssal:1,T4_Celestial:1,T5_Nidhogg:3,T5_Chaos:1,T5_Order:1,T6_Normal:2,T6_Giga:3,T7_DodoBleu:2,T7_DodoRouge:2,T7_WReaper:2,T7_WGiga:2,T8_Ascension:3,T8_Descension:3,T9_1Seal:5,T9_2Seal:6,T9_3Seal:6,T9_4Seal:6,T9_Cube:3}},"Combat Essence":{icon:`${l}combat_essence.png`,costs:{T4_Abyssal:10,T4_Celestial:10,T5_Nidhogg:10,T5_Chaos:10,T5_Order:10,T7_DodoBleu:10,T7_DodoRouge:10}},"Devilish Soul":{icon:`${l}devilish_soul.png`,costs:{T4_Abyssal:12,T5_Nidhogg:24,T5_Chaos:10,T5_Order:10,T6_Normal:10,T6_Giga:15,T7_DodoBleu:10,T7_DodoRouge:10,T7_WReaper:15,T7_WGiga:15,T8_Ascension:40,T8_Descension:40,T9_1Seal:35,T9_2Seal:40,T9_3Seal:40,T9_4Seal:60,T9_Cube:40}},"Divine Soul":{icon:`${l}divine_soul.png`,costs:{T4_Celestial:12,T5_Nidhogg:24,T5_Chaos:10,T5_Order:10,T6_Normal:10,T6_Giga:15,T7_DodoBleu:10,T7_DodoRouge:10,T7_WReaper:15,T7_WGiga:15,T8_Ascension:40,T8_Descension:40,T9_1Seal:35,T9_2Seal:40,T9_3Seal:40,T9_4Seal:60,T9_Cube:40}},"Devilish Hide":{icon:`${l}devilish_hide.png`,costs:{T4_Abyssal:500,T5_Nidhogg:3e3,T5_Chaos:1e3,T5_Order:1e3,T6_Normal:1e3,T6_Giga:2e3,T7_DodoBleu:1e3,T7_DodoRouge:1e3,T7_WReaper:1e3,T7_WGiga:1e3,T9_Cube:5e3}},"Divine Hide":{icon:`${l}divine_hide.png`,costs:{T4_Celestial:500,T5_Nidhogg:3e3,T5_Chaos:1e3,T5_Order:1e3,T6_Normal:1e3,T6_Giga:2e3,T7_DodoBleu:1e3,T7_DodoRouge:1e3,T7_WReaper:1e3,T7_WGiga:1e3,T9_Cube:5e3}},"Excellent Soul":{icon:`${l}excellent_soul.png`,costs:{T4_Abyssal:20,T4_Celestial:20,T5_Nidhogg:30,T5_Chaos:25,T5_Order:25,T6_Normal:25,T6_Giga:30,T7_DodoBleu:20,T7_DodoRouge:20,T7_WReaper:30,T7_WGiga:30,T8_Ascension:60,T8_Descension:60,T9_Cube:60}},"Unreal Essence":{icon:`${l}unreal_essence.png`,costs:{T4_Abyssal:50,T4_Celestial:50,T5_Nidhogg:1e3,T5_Chaos:100,T5_Order:100}},"Black Pearl":{icon:`${l}black_pearl.png`,costs:{T4_Abyssal:500,T4_Celestial:500,T5_Nidhogg:1500,T5_Chaos:1e3,T5_Order:1e3,T6_Normal:1e3,T6_Giga:1500,T7_DodoBleu:800,T7_DodoRouge:800,T7_WReaper:1e3,T7_WGiga:1e3,T8_Ascension:2e3,T8_Descension:2e3,T9_1Seal:1e3,T9_2Seal:1500,T9_3Seal:1500,T9_4Seal:1500,T9_Cube:2e3}},"Devilish Essence":{icon:`${l}devilish_essence.png`,costs:{T4_Abyssal:1}},"Divine Essence":{icon:`${l}divine_essence.png`,costs:{T4_Celestial:1}},"Abyssal Energy":{icon:`${l}abyssal_energy.png`,costs:{T4_Abyssal:10}},"Celestial Energy":{icon:`${l}celestial_energy.png`,costs:{T4_Celestial:10}},"Chaos Warchief Soul":{icon:`${l}chaos_warchief_soul.png`,costs:{T6_Normal:2,T6_Giga:2}},"Order Warchief Soul":{icon:`${l}order_warchief_soul.png`,costs:{T6_Normal:2,T6_Giga:2}},"Bionic Essence":{icon:`${l}bionic_essence.png`,costs:{T6_Giga:500}},"Bionic Soul":{icon:`${l}bionic_soul.png`,costs:{T7_DodoBleu:5,T7_DodoRouge:5,T7_WReaper:6,T7_WGiga:6}},"Descended Ingot":{icon:`${l}descended_ingot.png`,costs:{T7_DodoBleu:400,T7_DodoRouge:400,T7_WReaper:800,T7_WGiga:800,T9_1Seal:500,T9_2Seal:450,T9_3Seal:450,T9_4Seal:600}},"Ascended Warden Essence":{icon:`${l}ascended_warden_essence.png`,costs:{T7_WGiga:5,T8_Ascension:10,T9_Cube:8}},"Descended Warden Essence":{icon:`${l}descended_warden_essence.png`,costs:{T7_WReaper:5,T8_Descension:10,T9_Cube:8}},"Luminous Essence":{icon:`${l}luminous_essence.png`,costs:{T7_WReaper:200}},"Ancient Essence":{icon:`${l}ancient_essence.png`,costs:{T7_WGiga:1e3}},"Bionic Giga Essence":{icon:`${l}bionic_giga_essence.png`,costs:{T8_Ascension:1,T8_Descension:1}},"Descended Essence":{icon:`${l}descended_essence.png`,costs:{T7_WReaper:1e3,T7_WGiga:1e3,T8_Ascension:2500,T8_Descension:2500,T9_1Seal:2e3,T9_2Seal:3e3,T9_3Seal:3e3,T9_4Seal:3e3}},"Excellent Essence":{icon:`${l}excellent_essence.png`,costs:{T8_Ascension:2e3,T8_Descension:2e3}},"Warden Rex Trophy":{icon:`${l}warden_rex_trophy.png`,costs:{T8_Ascension:5,T8_Descension:5}},"Warden Spino Trophy":{icon:`${l}warden_spino_trophy.png`,costs:{T8_Ascension:5,T8_Descension:5}},"Warden Lizard Trophy":{icon:`${l}warden_lizard_trophy.png`,costs:{T8_Ascension:5,T8_Descension:5}},"Warden Theri Trophy":{icon:`${l}warden_theri_trophy.png`,costs:{T8_Ascension:5,T8_Descension:5}},"Supreme Warden Giga Trophy":{icon:`${l}supreme_warden_giga_trophy.png`,costs:{T8_Ascension:1,T8_Descension:1,T9_Cube:1}},"Supreme Warden Reaper Trophy":{icon:`${l}supreme_warden_reaper_trophy.png`,costs:{T8_Ascension:1,T8_Descension:1,T9_Cube:1}},"Soul of Ascension God":{icon:`${l}soul_ascension_god.png`,costs:{T9_1Seal:1,T9_2Seal:1,T9_3Seal:1,T9_4Seal:1,T9_Cube:1}},"Soul of Descension God":{icon:`${l}soul_descension_god.png`,costs:{T9_1Seal:1,T9_2Seal:1,T9_3Seal:1,T9_4Seal:1,T9_Cube:1}},"Seal Fragments":{icon:`${l}seal_fragment.png`,costs:{T9_Cube:2}}};function k(h,e){const t=_[h];return!t||!t.costs?0:t.costs[e]??0}function S(h){const e={};for(const[t,s]of Object.entries(_)){let n=!1;switch(h){case"boss":n=!t.toLowerCase().includes("key")&&!t.toLowerCase().includes("ancient token");break;case"key":n=t.toLowerCase().includes("key");break;case"ancient-token":n=t.toLowerCase().includes("ancient token");break}n&&(e[t]=s)}return e}class R{constructor(e="boss"){m(this,"selection",{});m(this,"previousResults",{});m(this,"history",[]);m(this,"saveTimeout",null);m(this,"calculatorType","boss");m(this,"onChange",null);m(this,"onHistoryChange",null);this.calculatorType=e,this.initSelection(),this.load()}setCalculatorType(e){this.calculatorType=e,this.previousResults={},this.onChange&&this.onChange(null,null)}getCalculatorType(){return this.calculatorType}initSelection(){C.forEach(e=>{this.selection[e]=p.defaultCount})}changeTier(e,t){if(!C.includes(e)){console.warn(`Tier invalide: ${e}`);return}const n=(this.selection[e]??p.defaultCount)+t;this.setTier(e,n)}setTier(e,t,s=!1){if(!C.includes(e)){console.warn(`Tier invalide: ${e}`);return}let n=typeof t=="string"?parseInt(t,10):t;isNaN(n)&&(n=p.defaultCount),n=Math.max(p.minCount,Math.min(p.maxCount,n)),this.selection[e]=n,this.scheduleSave(),!s&&this.onChange&&this.onChange(e,n)}getTier(e){return this.selection[e]??p.defaultCount}getSelection(){return{...this.selection}}calculateForTier(e){const t={},s=this.selection[e]??0;if(s===0)return t;const n=S(this.calculatorType);for(const i in n){const o=k(i,e);o>0&&(t[i]=o*s)}return t}calculate(){const e={},t=S(this.calculatorType);for(const[s,n]of Object.entries(this.selection))if(n!==0)for(const i in t){const o=k(i,s);o>0&&(e[i]=(e[i]||0)+o*n)}return this.previousResults=e,e}calculateSorted(){const e=this.calculate();return Object.keys(e).sort((t,s)=>t.localeCompare(s,"fr",{sensitivity:"base"})).map(t=>({item:t,quantity:e[t],icon:_[t].icon}))}reset(){C.forEach(e=>{this.selection[e]=p.defaultCount}),this.previousResults={},this.save(),this.onChange&&this.onChange(null,null)}clearTier(e){this.setTier(e,p.defaultCount)}export(){const e={version:1,selection:this.selection,timestamp:Date.now()};return JSON.stringify(e,null,2)}import(e){try{const t=JSON.parse(e);if(!t.selection||typeof t.selection!="object")throw new Error("Format invalide");for(const[s,n]of Object.entries(t.selection))C.includes(s)&&typeof n=="number"&&this.setTier(s,n,!0);return this.onChange&&this.onChange(null,null),this.save(),!0}catch(t){return console.error("Erreur lors de l'import:",t),!1}}save(){try{localStorage.setItem(p.storageKey,this.export())}catch(e){console.error("Erreur lors de la sauvegarde:",e)}}scheduleSave(){this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.save()},p.autoSaveDelay)}load(){try{const e=localStorage.getItem(p.storageKey);if(e)return this.import(e)}catch(e){console.error("Erreur lors du chargement:",e)}return!1}addToHistory(){const e={timestamp:Date.now(),selection:{...this.selection},results:this.calculate()};this.history.unshift(e),this.history.length>p.maxHistoryItems&&this.history.pop(),this.onHistoryChange&&this.onHistoryChange(this.history)}restoreFromHistory(e){if(e<0||e>=this.history.length)return!1;const t=this.history[e];for(const[s,n]of Object.entries(t.selection))this.setTier(s,n,!0);return this.onChange&&this.onChange(null,null),!0}getHistory(){return this.history}clearHistory(){this.history=[],this.onHistoryChange&&this.onHistoryChange(this.history)}exportResults(e="text"){const t=this.calculateSorted();switch(e){case"text":return this.exportAsText(t);case"markdown":return this.exportAsMarkdown(t);case"csv":return this.exportAsCSV(t);case"json":return JSON.stringify(t,null,2);default:return this.exportAsText(t)}}exportAsText(e){let t=`R√©sultats du Calculateur ARK: Primal Descended
`;t+="=".repeat(50)+`

`;for(const{item:s,quantity:n}of e)t+=`${s}: ${n}
`;return t}exportAsMarkdown(e){let t=`# R√©sultats du Calculateur ARK: Primal Descended

`;t+=`| Item | Quantit√© |
`,t+=`|------|----------|
`;for(const{item:s,quantity:n}of e)t+=`| ${s} | ${n} |
`;return t}exportAsCSV(e){let t=`Item,Quantit√©
`;for(const{item:s,quantity:n}of e)t+=`"${s}",${n}
`;return t}hasChanges(){return Object.values(this.selection).some(e=>e>0)}getSummary(){const e=Object.entries(this.selection).filter(([n,i])=>i>0),t=e.reduce((n,[i,o])=>n+o,0),s=Object.keys(this.calculate()).length;return{tiersSelected:e.length,totalQuantity:t,totalItemTypes:s}}}const A={abyssal:{"Abyssal Carcha Trophy":3,"Abyssal Dodoreaper Trophy":3,"Abyssal Dodorexy Trophy":3,"Abyssal Drake Trophy":3,"Abyssal Indominus Rex Trophy":3,"Abyssal Manticore Trophy":3,"Abyssal Spider Trophy":3,"Abyssal Element":3,"Abyssal Energy":300,Element:500,"Black Pearl":500,"Oracle Essence":100,"Unreal Essence":500},celestial:{"Celestial Gigant Trophy":3,"Celestial Gorilla Trophy":3,"Celestial Rhynio Trophy":3,"Celestial Rock Golem trophy":3,"Celestial Rock Drake Trophy":3,"Celestial Titano Trophy":3,"Celestial Wyvern Trophy":3,"Celestial Element":3,"Celestial Energy":300,Element:500,"Black Pearl":500,"Oracle Essence":100,"Unreal Essence":500},god:{"Abyssal Energy":200,"Celestial Energy":200,"Ancient Token Cluster":1,"Unreal Essence":500,"Abyssal Carcha Soul":5,"Abyssal Dodoreaper Soul":5,"Abyssal Dodorexy Soul":5,"Abyssal Drake Soul":5,"Abyssal Indominus Rex Soul":5,"Abyssal Manticore Soul":5,"Abyssal Spider Soul":5,"Celestial Gigant Soul":5,"Celestial Gorilla Soul":5,"Celestial Rhynio Soul":5,"Celestial Rock Golem Soul":5,"Celestial Rock Drake Soul":5,"Celestial Titano Soul":5,"Celestial Wyvern Soul":5}};function N(h){const e={};for(const[t,s]of Object.entries(A.abyssal))e[t]=s*h;return e}function $(h){const e={};for(const[t,s]of Object.entries(A.celestial))e[t]=s*h;return e}function L(h){const e={};for(const[t,s]of Object.entries(A.god))e[t]=s*h;return e}const B={"Raptor Token":`${l}Raptor's Ancient Token.png`,"Carno Token":`${l}Carno's Ancient Token.png`,"Bronto Token":`${l}Bronto's Ancient Token.png`,"Giga Token":`${l}Gigant's Ancient Token.png`,"Rex Token":`${l}Rex's Ancient Token.png`,"Trike Token":`${l}Trike's Ancient Token.png`,"Stego Token":`${l}Stego's Ancient Token.png`,"Quetz Token":`${l}Quetz's Ancient Token.png`,"Wyvern Token":`${l}Wyvern's Ancient Token.png`},D={tokens:{"Raptor Token":2,"Carno Token":2,"Bronto Token":2,"Giga Token":2,"Rex Token":2,"Trike Token":2,"Stego Token":2,"Quetz Token":2,"Wyvern Token":2},resources:{"Black Pearl":80,"Excellent Essence":100,"Unreal Essence":20,"Excellent Soul":5,"Descended Essence":200,Artefact:1}};function O(h){const e={};for(const[t,s]of Object.entries(D.tokens))e[t]=s*h;return e}function K(h){const e={};for(const[t,s]of Object.entries(D.resources))e[t]=s*h;return e}class W{constructor(e){m(this,"calculator");m(this,"tiersContainer");m(this,"resultsContainer");m(this,"resetBtn");m(this,"tierInputs",{});m(this,"keyInputs",{abyssal:null,celestial:null,god:null});m(this,"tokenInput",null);m(this,"ancientDinoInput",null);m(this,"inputTimeout",null);m(this,"toastTimeout",null);this.calculator=e,this.tiersContainer=document.getElementById("tiers"),this.resultsContainer=document.getElementById("results"),this.resetBtn=document.getElementById("resetBtn"),this.init()}createTiersUI(){this.tiersContainer&&(this.tiersContainer.innerHTML="",this.tiersContainer.classList.remove("tiers-container-keys"),this.tiersContainer.classList.contains("tiers-grid")||this.tiersContainer.classList.add("tiers-grid"),C.forEach(e=>{const t=this.createTierElement(e);this.tiersContainer.appendChild(t)}),requestAnimationFrame(()=>{if(this.tiersContainer){this.tiersContainer.offsetHeight;const e=this.tiersContainer.style.display;this.tiersContainer.style.display="none",requestAnimationFrame(()=>{this.tiersContainer&&(this.tiersContainer.style.display=e||"")})}}))}init(){if(!this.tiersContainer||!this.resultsContainer){console.error("√âl√©ments DOM manquants");return}const e=this.calculator.getCalculatorType();e==="boss"?this.createTiersUI():e==="key"?this.createKeysUI():e==="ancient-token"?this.createTokenUI():this.showEmptyState(),this.setupEventListeners(),this.calculator.onChange=this.onCalculatorChange.bind(this),this.updateResults()}createKeysUI(){if(!this.tiersContainer)return;this.tiersContainer.innerHTML="",this.tiersContainer.classList.remove("tiers-grid"),this.tiersContainer.classList.add("tiers-container-keys");const e=this.createKeyElement("abyssal","Abyssal Warfare Key","CRAFT NORMAL","abyssal_key.png"),t=this.createKeyElement("celestial","Celestial Warfare Key","CRAFT NORMAL","celestial_key.png"),s=this.createKeyElement("god","God Key","CRAFT GOD KEY","god_key.png");this.tiersContainer.appendChild(e),this.tiersContainer.appendChild(t),this.tiersContainer.appendChild(s)}createTokenUI(){if(!this.tiersContainer)return;this.tiersContainer.innerHTML="",this.tiersContainer.classList.remove("tiers-grid"),this.tiersContainer.classList.add("tiers-container-keys");const e=document.createElement("div");e.className="tier",e.setAttribute("data-token-type","ancient-token");const t=document.createElement("div");t.className="tier-header";const s=document.createElement("img");s.src=`${l}ancient_token.png`,s.alt="Ancient Token Cluster",s.loading="lazy",s.className="tier-icon";const n=document.createElement("div");n.className="tier-info";const i=document.createElement("div");i.className="tier-name",i.textContent="Ancient Token Cluster";const o=document.createElement("span");o.className="tier-category",o.textContent="ANCIENT TOKEN",n.appendChild(i),n.appendChild(o),t.appendChild(s),t.appendChild(n);const a=document.createElement("p");a.className="tier-description",a.textContent="Entrez le nombre d'Ancient Token Clusters que vous souhaitez craft.";const u=document.createElement("div");u.className="counter";const c=document.createElement("button");c.className="minus",c.setAttribute("data-token-type","ancient-token"),c.setAttribute("data-token-action","decrement"),c.setAttribute("aria-label","Diminuer le nombre d'Ancient Token Clusters"),c.textContent="‚àí";const r=document.createElement("input");r.type="number",r.id="count-ancient-token",r.className="count",r.setAttribute("data-token-type","ancient-token"),r.min=String(p.minCount),r.max=String(p.maxCount),r.value="0",r.setAttribute("aria-label","Nombre d'Ancient Token Clusters"),r.setAttribute("aria-describedby","token-description"),r.setAttribute("aria-invalid","false");const d=document.createElement("button");d.className="plus",d.setAttribute("data-token-type","ancient-token"),d.setAttribute("data-token-action","increment"),d.setAttribute("aria-label","Augmenter le nombre d'Ancient Token Clusters"),d.textContent="+",u.appendChild(c),u.appendChild(r),u.appendChild(d);const T=document.createElement("span");T.className="error-message",T.id="token-description",T.setAttribute("role","alert"),T.setAttribute("aria-live","polite"),e.appendChild(t),e.appendChild(a),e.appendChild(u),e.appendChild(T),this.tiersContainer.appendChild(e),this.tokenInput=r,r.addEventListener("input",y=>{const f=y.target,b=parseInt(f.value,10)||0;this.handleTokenInputChange(b)});const g=this.createAncientDinoCard();this.tiersContainer.appendChild(g),this.tiersContainer.offsetHeight}createAncientDinoCard(){const e=document.createElement("div");e.className="tier",e.setAttribute("data-token-type","ancient-dino");const t=document.createElement("div");t.className="tier-header";const s=document.createElement("img");s.src=`${l}ancient_token.png`,s.alt="Ancient Dino",s.loading="lazy",s.className="tier-icon";const n=document.createElement("div");n.className="tier-info";const i=document.createElement("div");i.className="tier-name",i.textContent="Ancient Dino";const o=document.createElement("span");o.className="tier-category",o.textContent="ANCIENT DINO",n.appendChild(i),n.appendChild(o),t.appendChild(s),t.appendChild(n);const a=document.createElement("p");a.className="tier-description",a.textContent="Entrez le nombre d'Ancient Token Clusters pour voir les ressources Ancient Dino n√©cessaires.";const u=document.createElement("div");u.className="counter";const c=document.createElement("button");c.className="minus",c.setAttribute("data-token-type","ancient-dino"),c.setAttribute("data-token-action","decrement"),c.setAttribute("aria-label","Diminuer le nombre d'Ancient Token Clusters pour Ancient Dino"),c.textContent="‚àí";const r=document.createElement("input");r.type="number",r.id="count-ancient-dino",r.className="count",r.setAttribute("data-token-type","ancient-dino"),r.min=String(p.minCount),r.max=String(p.maxCount),r.value="0",r.setAttribute("aria-label","Nombre d'Ancient Token Clusters pour Ancient Dino"),r.setAttribute("aria-describedby","ancient-dino-description"),r.setAttribute("aria-invalid","false");const d=document.createElement("button");d.className="plus",d.setAttribute("data-token-type","ancient-dino"),d.setAttribute("data-token-action","increment"),d.setAttribute("aria-label","Augmenter le nombre d'Ancient Token Clusters pour Ancient Dino"),d.textContent="+",u.appendChild(c),u.appendChild(r),u.appendChild(d);const T=document.createElement("span");return T.className="error-message",T.id="ancient-dino-description",T.setAttribute("role","alert"),T.setAttribute("aria-live","polite"),e.appendChild(t),e.appendChild(a),e.appendChild(u),e.appendChild(T),this.ancientDinoInput=r,r.addEventListener("input",g=>{const y=g.target,f=parseInt(y.value,10)||0;this.handleAncientDinoInputChange(f)}),e}createKeyElement(e,t,s,n){const i=document.createElement("div");i.className="tier",i.setAttribute("data-key-type",e);const o=document.createElement("div");o.className="tier-header";const a=document.createElement("img");a.src=`${l}${n}`,a.alt=t,a.loading="lazy",a.className="tier-icon";const u=document.createElement("div");u.className="tier-info";const c=document.createElement("div");c.className="tier-name",c.textContent=t;const r=document.createElement("span");r.className="tier-category",r.textContent=s,u.appendChild(c),u.appendChild(r),o.appendChild(a),o.appendChild(u);const d=document.createElement("p");d.className="tier-description",e==="god"?d.textContent="Entrez le nombre de God Keys que vous souhaitez craft.":d.textContent=`Entrez le nombre de ${t} que vous souhaitez craft.`;const T=document.createElement("div");T.className="counter";const g=document.createElement("button");g.className="minus",g.setAttribute("data-key-type",e),g.setAttribute("data-action","decrement"),g.setAttribute("aria-label",`Diminuer ${t}`),g.textContent="‚àí";const y=document.createElement("input");y.type="number",y.id=`count-${e}`,y.className="count",y.setAttribute("data-key-type",e),y.min=String(0),y.max=String(p.maxCount),y.value="0",y.step="1",y.setAttribute("aria-label",`Nombre de ${t}`),y.setAttribute("aria-describedby",`count-${e}-desc`),y.setAttribute("aria-invalid","false");const f=document.createElement("span");f.id=`count-${e}-desc`,f.className="sr-only",f.textContent=`Valeur entre 0 et ${p.maxCount}`,this.keyInputs[e]=y;const b=document.createElement("button");return b.className="plus",b.setAttribute("data-key-type",e),b.setAttribute("data-action","increment"),b.setAttribute("aria-label",`Augmenter ${t}`),b.textContent="+",T.appendChild(g),T.appendChild(y),T.appendChild(f),T.appendChild(b),i.appendChild(o),i.appendChild(d),i.appendChild(T),i}showEmptyState(){this.tiersContainer&&(this.tiersContainer.innerHTML='<p class="empty-state">Cette fonctionnalit√© sera disponible prochainement</p>')}createTierElement(e){const t=document.createElement("div");t.className="tier",t.setAttribute("data-tier",e);const s=document.createElement("div");s.className="tier-header";const n=document.createElement("img");n.src=`${l}${e}.png`,n.alt=E(e),n.loading="lazy",n.className="tier-icon";const i=document.createElement("div");i.className="tier-info";const o=document.createElement("div");o.className="tier-name",o.textContent=E(e);const a=document.createElement("span");a.className="tier-category",a.textContent=this.getTierCategory(e),i.appendChild(o),i.appendChild(a),s.appendChild(n),s.appendChild(i);const u=document.createElement("p");u.className="tier-description",u.textContent=`S√©lectionnez la quantit√© de ${E(e)} n√©cessaire pour votre calcul.`;const c=document.createElement("div");c.className="counter";const r=document.createElement("button");r.className="minus",r.setAttribute("data-tier",e),r.setAttribute("data-action","decrement"),r.setAttribute("aria-label",`Diminuer ${E(e)}`),r.textContent="‚àí";const d=document.createElement("input");d.type="number",d.id=`count-${e}`,d.className="count",d.setAttribute("data-tier",e),d.min=String(p.minCount),d.max=String(p.maxCount),d.value=String(this.calculator.getTier(e)),d.setAttribute("aria-label",`Quantit√© ${E(e)}`),d.setAttribute("aria-describedby",`count-${e}-desc`),d.setAttribute("aria-invalid","false");const T=document.createElement("span");T.id=`count-${e}-desc`,T.className="sr-only",T.textContent=`Valeur entre ${p.minCount} et ${p.maxCount}`,this.tierInputs[e]=d;const g=document.createElement("button");return g.className="plus",g.setAttribute("data-tier",e),g.setAttribute("data-action","increment"),g.setAttribute("aria-label",`Augmenter ${E(e)}`),g.textContent="+",c.appendChild(r),c.appendChild(d),c.appendChild(T),c.appendChild(g),t.appendChild(s),t.appendChild(u),t.appendChild(c),t}getTierCategory(e){return e.startsWith("T4")?"TIER 4":e.startsWith("T5")?"TIER 5":e.startsWith("T6")?"TIER 6":e.startsWith("T7")?"TIER 7":e.startsWith("T8")?"TIER 8":e.includes("Celestial")?"C√âLESTE":e.includes("Abyssal")?"ABYSSAL":"TIER"}setupEventListeners(){this.tiersContainer&&(this.tiersContainer.addEventListener("click",this.handleTierClick.bind(this)),this.tiersContainer.addEventListener("input",this.handleTierInput.bind(this)),this.resetBtn&&this.resetBtn.addEventListener("click",this.handleReset.bind(this)),this.tiersContainer.addEventListener("keydown",this.handleKeyDown.bind(this)))}handleTierClick(e){const s=e.target.closest("button");if(!s)return;const n=s.getAttribute("data-tier"),i=s.getAttribute("data-key-type"),o=s.getAttribute("data-token-type"),a=s.getAttribute("data-action")||s.getAttribute("data-token-action");if(o&&a){let u=null;if(o==="ancient-token"?u=this.tokenInput:o==="ancient-dino"&&(u=this.ancientDinoInput),!u)return;let c=parseInt(u.value,10)||0;const r=1;switch(a){case"increment":c+=r,u.value=String(c),o==="ancient-token"?this.handleTokenInputChange(c):o==="ancient-dino"&&this.handleAncientDinoInputChange(c);break;case"decrement":c=Math.max(0,c-r),u.value=String(c),o==="ancient-token"?this.handleTokenInputChange(c):o==="ancient-dino"&&this.handleAncientDinoInputChange(c);break}return}if(i&&a){const u=this.keyInputs[i];if(!u)return;let c=parseInt(u.value,10)||0;const r=1;switch(a){case"increment":c+=r,u.value=String(c),this.handleKeyInputChange(i,c);break;case"decrement":c=Math.max(0,c-r),u.value=String(c),this.handleKeyInputChange(i,c);break}return}if(!(!n||!a))switch(a){case"increment":this.calculator.changeTier(n,1);break;case"decrement":this.calculator.changeTier(n,-1);break;case"clear":this.calculator.clearTier(n);break}}handleTokenInputChange(e){const t=Math.max(0,Math.min(e,p.maxCount));this.tokenInput&&(this.tokenInput.value=String(t)),this.updateResults()}getTokenValue(){return parseInt(this.tokenInput?.value||"0",10)||0}handleAncientDinoInputChange(e){const t=Math.max(0,Math.min(e,p.maxCount));this.ancientDinoInput&&(this.ancientDinoInput.value=String(t)),this.updateResults()}getAncientDinoValue(){return parseInt(this.ancientDinoInput?.value||"0",10)||0}handleKeyInputChange(e,t){this.updateResults()}handleTierInput(e){const t=e.target;if(!t||!t.classList.contains("count"))return;const s=t.getAttribute("data-tier"),n=t.getAttribute("data-key-type"),i=t.getAttribute("data-token-type");if(i){const d=parseInt(t.value,10)||0;i==="ancient-token"?this.handleTokenInputChange(d):i==="ancient-dino"&&this.handleAncientDinoInputChange(d);return}if(n){const d=parseInt(t.value,10)||0;this.handleKeyInputChange(n,d);return}if(!s)return;const o=parseInt(t.value,10),a=p.minCount,u=p.maxCount,c=!isNaN(o)&&o>=a&&o<=u;t.setAttribute("aria-invalid",c?"false":"true");const r=t.getAttribute("aria-describedby");if(r){const d=document.getElementById(r);d&&(c?(d.textContent=`Valeur entre ${a} et ${u}`,d.className="sr-only"):(d.textContent=`Erreur: La valeur doit √™tre entre ${a} et ${u}`,d.className="error-message"))}this.inputTimeout&&clearTimeout(this.inputTimeout),this.inputTimeout=setTimeout(()=>{c?this.calculator.setTier(s,o):t.value=String(this.calculator.getTier(s))},p.inputDebounceDelay)}handleKeyDown(e){const t=e.target;t&&t.classList.contains("count")&&e.key==="Enter"&&(e.preventDefault(),t.blur())}handleReset(){const e=this.calculator.getCalculatorType();e==="key"?(this.keyInputs.abyssal&&(this.keyInputs.abyssal.value="0"),this.keyInputs.celestial&&(this.keyInputs.celestial.value="0"),this.keyInputs.god&&(this.keyInputs.god.value="0"),this.updateResults(),this.showToast("Tous les compteurs de cl√©s ont √©t√© r√©initialis√©s")):e==="ancient-token"?(this.tokenInput&&(this.tokenInput.value="0"),this.ancientDinoInput&&(this.ancientDinoInput.value="0"),this.updateResults(),this.showToast("Les compteurs d'Ancient Token Clusters et Ancient Dino ont √©t√© r√©initialis√©s")):(this.calculator.reset(),this.showToast("Tous les compteurs ont √©t√© r√©initialis√©s"))}onCalculatorChange(e,t){if(e===null)C.forEach(s=>{const n=this.tierInputs[s];n&&(n.value=String(this.calculator.getTier(s)))});else{const s=this.tierInputs[e];s&&t!==null&&(s.value=String(t))}this.updateResults()}updateResults(){if(!this.resultsContainer)return;const e=this.calculator.getCalculatorType();if(e==="key"){this.updateKeyResults();return}if(e==="ancient-token"){this.updateTokenResults();return}this.updateBossResults()}updateBossResults(){if(!this.resultsContainer)return;if(this.calculator.calculateSorted().length===0){this.resultsContainer.innerHTML='<p class="no-results">S√©lectionnez des tiers pour voir les ressources n√©cessaires</p>';return}this.resultsContainer.innerHTML="";const t={},s=this.calculator.getSelection();for(const[n,i]of Object.entries(s))if(i>0&&C.includes(n)){const o=this.calculator.calculateForTier(n);Object.keys(o).length>0&&(t[n]=Object.entries(o).map(([a,u])=>({item:a,quantity:u,icon:_[a]?.icon||`${l}default.png`})).sort((a,u)=>u.quantity-a.quantity))}for(const[n,i]of Object.entries(t))if(i.length>0){const o=document.createElement("h3");o.className="results-section-title",o.textContent=E(n),this.resultsContainer.appendChild(o),i.forEach(({item:a,quantity:u,icon:c})=>{const r=this.createResultElement(a,u,c);this.resultsContainer.appendChild(r)})}}updateKeyResults(){if(!this.resultsContainer)return;const e=parseInt(this.keyInputs.abyssal?.value||"0",10)||0,t=parseInt(this.keyInputs.celestial?.value||"0",10)||0,s=parseInt(this.keyInputs.god?.value||"0",10)||0;if(e===0&&t===0&&s===0){this.resultsContainer.innerHTML='<p class="no-results">Entrez le nombre de cl√©s souhait√©es pour voir les ressources n√©cessaires</p>';return}if(this.resultsContainer.innerHTML="",e>0){const n=N(e),i=[];for(const[o,a]of Object.entries(n))a>0&&i.push({name:o,quantity:Math.ceil(a)});if(i.sort((o,a)=>a.quantity-o.quantity),i.length>0){const o=document.createElement("h3");o.className="results-section-title",o.textContent="Abyssal Warfare Key",this.resultsContainer.appendChild(o),i.forEach(({name:a,quantity:u})=>{const r=_[a]?.icon||`${l}default.png`,d=this.createResultElement(a,u,r);this.resultsContainer.appendChild(d)})}}if(t>0){const n=$(t),i=[];for(const[o,a]of Object.entries(n))a>0&&i.push({name:o,quantity:Math.ceil(a)});if(i.sort((o,a)=>a.quantity-o.quantity),i.length>0){const o=document.createElement("h3");o.className="results-section-title",o.textContent="Celestial Warfare Key",this.resultsContainer.appendChild(o),i.forEach(({name:a,quantity:u})=>{const r=_[a]?.icon||`${l}default.png`,d=this.createResultElement(a,u,r);this.resultsContainer.appendChild(d)})}}if(s>0){const n=L(s),i=[];for(const[o,a]of Object.entries(n))a>0&&i.push({name:o,quantity:Math.ceil(a)});if(i.sort((o,a)=>a.quantity-o.quantity),i.length>0){const o=document.createElement("h3");o.className="results-section-title",o.textContent="God Key",this.resultsContainer.appendChild(o),i.forEach(({name:a,quantity:u})=>{const r=_[a]?.icon||`${l}default.png`,d=this.createResultElement(a,u,r);this.resultsContainer.appendChild(d)})}}this.resultsContainer.children.length===0&&(this.resultsContainer.innerHTML='<p class="no-results">Aucune ressource n√©cessaire</p>')}updateTokenResults(){if(!this.resultsContainer)return;const e=parseInt(this.tokenInput?.value||"0",10)||0,t=parseInt(this.ancientDinoInput?.value||"0",10)||0;if(e===0&&t===0){this.resultsContainer.innerHTML=`<p class="no-results">Entrez le nombre d'Ancient Token Clusters souhait√©s pour voir les ressources n√©cessaires</p>`;return}if(this.resultsContainer.innerHTML="",e>0){const s=O(e),n=[];for(const[i,o]of Object.entries(s))o>0&&n.push({name:i,quantity:Math.ceil(o)});if(n.sort((i,o)=>o.quantity-i.quantity),n.length>0){const i=document.createElement("h3");i.className="results-section-title",i.textContent="Ancient Token Cluster",this.resultsContainer.appendChild(i),n.forEach(({name:o,quantity:a})=>{let u=B[o]||`${l}ancient_token.png`;const c=this.createResultElement(o,a,u);this.resultsContainer.appendChild(c)})}}if(t>0){const s=K(t),n=[];for(const[i,o]of Object.entries(s))o>0&&n.push({name:i,quantity:Math.ceil(o)});if(n.sort((i,o)=>o.quantity-i.quantity),n.length>0){const i=document.createElement("h3");i.className="results-section-title",i.textContent="Ancient Dino",this.resultsContainer.appendChild(i),n.forEach(({name:o,quantity:a})=>{let u=`${l}default.png`;const c=_[o];c?.icon&&(u=c.icon);const r=this.createResultElement(o,a,u);this.resultsContainer.appendChild(r)})}}this.resultsContainer.children.length===0&&(this.resultsContainer.innerHTML='<p class="no-results">Aucune ressource n√©cessaire</p>')}createResultElement(e,t,s){const n=document.createElement("div");n.className="result",n.setAttribute("data-item",e);const i=document.createElement("img");i.src=s,i.alt=e,i.loading="lazy";const o=document.createElement("span");o.textContent=`${e}: `;const a=document.createElement("strong");return a.textContent=String(t),n.appendChild(i),n.appendChild(o),n.appendChild(a),n}showToast(e,t=p.toastDuration){const s=document.querySelector(".toast");s&&s.remove();const n=document.createElement("div");n.className="toast",n.textContent=e,n.setAttribute("role","status"),n.setAttribute("aria-live","polite"),document.body.appendChild(n),n.offsetHeight,n.style.opacity="1",this.toastTimeout&&clearTimeout(this.toastTimeout),this.toastTimeout=setTimeout(()=>{n.style.opacity="0",setTimeout(()=>n.remove(),300)},t)}async showExportDialog(){const e=[{value:"text",label:"Texte"},{value:"markdown",label:"Markdown"},{value:"csv",label:"CSV"},{value:"json",label:"JSON"}],t=prompt(`Format d'export:
${e.map((i,o)=>`${o+1}. ${i.label}`).join(`
`)}

Entrez le num√©ro:`);if(t===null)return;const s=parseInt(t,10)-1,n=e[s];if(s>=0&&s<e.length&&n){const i=n.value,o=this.calculator.exportResults(i);await this.copyToClipboard(o),this.showToast(`R√©sultats export√©s en ${n.label} et copi√©s !`)}}async copyToClipboard(e){try{return await navigator.clipboard.writeText(e),!0}catch(t){console.error("Erreur lors de la copie:",t);const s=document.createElement("textarea");return s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),!0}}downloadFile(e,t,s="text/plain"){const n=new Blob([e],{type:s}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}async confirm(e){return window.confirm(e)}refreshCounters(){C.forEach(e=>{const t=this.tierInputs[e];t&&(t.value=String(this.calculator.getTier(e)))})}}const v={sun:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="4"></circle>
    <path d="M12 2v2"></path>
    <path d="M12 20v2"></path>
    <path d="m4.93 4.93 1.41 1.41"></path>
    <path d="m17.66 17.66 1.41 1.41"></path>
    <path d="M2 12h2"></path>
    <path d="M20 12h2"></path>
    <path d="m6.34 17.66-1.41 1.41"></path>
    <path d="m19.07 4.93-1.41 1.41"></path>
  </svg>`,moon:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
  </svg>`,laptop:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect width="18" height="12" x="3" y="4" rx="2" ry="2"></rect>
    <line x1="2" x2="22" y1="20" y2="20"></line>
  </svg>`};class q{constructor(e,t){m(this,"container");m(this,"currentMode");m(this,"modes",["light","dark","system"]);m(this,"onModeChange");m(this,"mediaQueryListener");const s=document.getElementById(e);if(!s)throw new Error(`Container with id "${e}" not found`);this.container=s,this.onModeChange=t;const n=localStorage.getItem(p.themeStorageKey);n==="light"||n==="dark"||n==="system"?this.currentMode=n:this.currentMode="dark",this.render(),this.setupEventListeners(),this.applyTheme()}render(){this.container.innerHTML="",this.container.className="theme-switch-container";const e=document.createElement("div");e.className="theme-switch",e.setAttribute("role","group"),e.setAttribute("aria-label","S√©lectionner le th√®me"),this.modes.forEach(t=>{const s=document.createElement("button");s.className=`theme-switch-button ${t===this.currentMode?"active":""}`,s.setAttribute("data-mode",t),s.setAttribute("aria-label",this.getModeLabel(t)),s.setAttribute("aria-pressed",t===this.currentMode?"true":"false"),s.setAttribute("type","button");const n=document.createElement("span");n.className="theme-switch-icon";const a=new DOMParser().parseFromString(this.getIcon(t),"image/svg+xml").documentElement;a&&n.appendChild(a),s.appendChild(n),e.appendChild(s)}),this.container.appendChild(e)}getIcon(e){switch(e){case"light":return v.sun;case"dark":return v.moon;case"system":return v.laptop}}getModeLabel(e){switch(e){case"light":return"Mode clair";case"dark":return"Mode sombre";case"system":return"Mode syst√®me"}}setupEventListeners(){if(this.container.querySelectorAll(".theme-switch-button").forEach(t=>{t.addEventListener("click",s=>{s.preventDefault();const n=t.getAttribute("data-mode");n&&this.setMode(n)})}),window.matchMedia&&!this.mediaQueryListener){const t=window.matchMedia("(prefers-color-scheme: dark)");this.mediaQueryListener=()=>{this.currentMode==="system"&&this.applyTheme()},t.addEventListener("change",this.mediaQueryListener)}}setMode(e){this.currentMode!==e&&(this.currentMode=e,localStorage.setItem(p.themeStorageKey,e),this.render(),this.setupEventListeners(),this.applyTheme(),this.onModeChange&&this.onModeChange(e))}getMode(){return this.currentMode}getEffectiveTheme(){return this.currentMode==="system"?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":this.currentMode}applyTheme(){const e=this.getEffectiveTheme();document.documentElement.setAttribute("data-theme",e)}}class G{constructor(){m(this,"themeSwitch",null);this.init()}init(){try{this.themeSwitch=new q("themeToggleContainer",e=>{console.log(`Theme chang√© vers: ${e}`)})}catch(e){console.error("Erreur lors de l'initialisation du ThemeSwitch:",e)}}getTheme(){return this.themeSwitch?.getEffectiveTheme()||p.defaultTheme}getMode(){return this.themeSwitch?.getMode()||p.defaultTheme}}class j{constructor(e,t){m(this,"calculator");m(this,"ui");this.calculator=e,this.ui=t,this.setupFeatures()}setupFeatures(){const e=document.getElementById("exportBtn");e&&e.addEventListener("click",n=>{n.preventDefault(),this.handleExport()});const t=document.getElementById("importBtn");t&&t.addEventListener("click",n=>{n.preventDefault(),this.handleImport()});const s=document.getElementById("copyResultsBtn");s&&s.addEventListener("click",n=>{n.preventDefault(),this.handleCopyResults()}),this.setupKeyboardShortcuts()}handleExport(){const e=this.calculator.export(),s=`ark-calculator-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5)}.json`;this.ui.downloadFile(e,s,"application/json"),this.ui.showToast("Configuration export√©e avec succ√®s!")}async handleImport(){const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",async t=>{const n=t.target.files?.[0];if(n)try{const i=await n.text();this.calculator.import(i)?(this.ui.refreshCounters(),this.ui.showToast("Configuration import√©e avec succ√®s!")):this.ui.showToast("Erreur: fichier invalide")}catch(i){console.error("Erreur lors de l'import:",i),this.ui.showToast("Erreur lors de l'import")}}),e.click()}async handleCopyResults(){if(!this.calculator.hasChanges()){this.ui.showToast("Aucun r√©sultat √† copier");return}const e=this.calculator.exportResults("text");await this.ui.copyToClipboard(e)?this.ui.showToast("R√©sultats copi√©s dans le presse-papier!"):this.ui.showToast("Erreur lors de la copie")}setupKeyboardShortcuts(){document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="e"&&(e.preventDefault(),this.handleExport()),(e.ctrlKey||e.metaKey)&&e.key==="i"&&(e.preventDefault(),this.handleImport()),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="C"&&(e.preventDefault(),this.handleCopyResults()),(e.ctrlKey||e.metaKey)&&e.key==="r"&&(e.preventDefault(),this.calculator.reset(),this.ui.showToast("Tous les compteurs ont √©t√© r√©initialis√©s"))})}}class P{constructor(){m(this,"calculator",null);m(this,"ui",null);m(this,"themeManager",null);m(this,"currentCalculatorType","boss")}async init(){console.log("üöÄ Initialisation du calculateur ARK: Primal Descended...");try{const t=new URLSearchParams(window.location.search).get("type"),s=localStorage.getItem("calculator_type");this.currentCalculatorType=t||s||"boss",this.calculator=new R(this.currentCalculatorType),console.log(`‚úÖ Calculator initialis√© (type: ${this.currentCalculatorType})`),this.ui=new W(this.calculator),console.log("‚úÖ UI initialis√©e"),this.themeManager=new G,console.log("‚úÖ Theme manager initialis√©"),new j(this.calculator,this.ui),console.log("‚úÖ Feature manager initialis√©"),this.setupThanksModal(),console.log("‚úÖ Modal de remerciements initialis√©"),this.setupCalculatorTypeNavigation(),this.updatePageTitle(),console.log("‚úÖ Navigation des types de calculateurs initialis√©e"),this.calculator.hasChanges()?this.ui.showToast("Configuration restaur√©e depuis la sauvegarde"):this.ui.showToast("Bienvenue sur le calculateur ARK!"),console.log("‚ú® Application pr√™te!"),(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(window.arkApp={calculator:this.calculator,ui:this.ui,themeManager:this.themeManager},console.log("üîß Mode d√©veloppement: arkApp expos√© dans window"))}catch(e){console.error("‚ùå Erreur lors de l'initialisation:",e),alert("Erreur lors du chargement de l'application. Veuillez rafra√Æchir la page.")}}setupThanksModal(){const e=document.getElementById("thanksBtn"),t=document.getElementById("thanksModal"),s=t?.querySelector(".modal-close"),n=t?.querySelector(".modal-overlay");if(!e||!t)return;e.addEventListener("click",()=>{t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",s?.focus()});const i=()=>{t.setAttribute("aria-hidden","true"),document.body.style.overflow="",e.focus()};s?.addEventListener("click",i),n?.addEventListener("click",i),t.addEventListener("keydown",o=>{o.key==="Escape"&&t.getAttribute("aria-hidden")==="false"&&i()})}setupCalculatorTypeNavigation(){const e=document.querySelectorAll(".calc-type-btn");document.querySelector(".page-title h1"),document.querySelector(".page-title p"),e.forEach(t=>{const s=t.getAttribute("data-type");s===this.currentCalculatorType&&t.classList.add("active"),t.addEventListener("click",()=>{this.switchCalculatorType(s),this.closeMobileMenu()})}),this.setupMobileMenu(),this.updatePageTitle()}setupMobileMenu(){const e=document.getElementById("mobileMenuBtn"),t=document.getElementById("mobileMenu");!e||!t||(e.addEventListener("click",s=>{s.stopPropagation(),this.toggleMobileMenu()}),document.addEventListener("click",s=>{const n=s.target;!t.contains(n)&&!e.contains(n)&&this.closeMobileMenu()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&t.getAttribute("aria-hidden")==="false"&&this.closeMobileMenu()}))}toggleMobileMenu(){const e=document.getElementById("mobileMenuBtn"),t=document.getElementById("mobileMenu");if(!e||!t)return;t.getAttribute("aria-hidden")==="false"?this.closeMobileMenu():this.openMobileMenu()}openMobileMenu(){const e=document.getElementById("mobileMenuBtn"),t=document.getElementById("mobileMenu");!e||!t||(e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"),e.setAttribute("aria-label","Fermer le menu"))}closeMobileMenu(){const e=document.getElementById("mobileMenuBtn"),t=document.getElementById("mobileMenu");!e||!t||(e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),e.setAttribute("aria-label","Ouvrir le menu"))}switchCalculatorType(e){if(e===this.currentCalculatorType)return;this.currentCalculatorType=e,localStorage.setItem("calculator_type",e),this.calculator&&this.calculator.setCalculatorType(e),this.updateActiveButton(e),this.updatePageTitle(),this.ui&&(this.updateTiersDisplay(e),this.ui.updateResults());const t=new URL(window.location.href);t.searchParams.set("type",e),window.history.pushState({type:e},"",t.toString())}updateTiersDisplay(e){!this.ui||!document.getElementById("tiers")||(e==="boss"?this.ui.createTiersUI():e==="key"?this.ui.createKeysUI():e==="ancient-token"?this.ui.createTokenUI():this.ui.showEmptyState())}updateActiveButton(e){document.querySelectorAll(".calc-type-btn").forEach(s=>{s.getAttribute("data-type")===e?s.classList.add("active"):s.classList.remove("active")})}updatePageTitle(){const e=document.querySelector(".page-title h1"),t=document.querySelector(".page-title p"),s=x[this.currentCalculatorType];e&&(e.textContent=s.label),t&&(t.textContent=s.description)}cleanup(){this.calculator&&this.calculator.save()}}document.addEventListener("DOMContentLoaded",()=>{const h=new P;h.init(),window.addEventListener("beforeunload",()=>{h.cleanup()})});window.addEventListener("error",h=>{console.error("Erreur globale:",h.error)});window.addEventListener("unhandledrejection",h=>{console.error("Promise rejet√©e:",h.reason)});
